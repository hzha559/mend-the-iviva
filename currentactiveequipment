USE [510cs]
GO

/****** Object:  StoredProcedure [dbo].[Cl_currentactiveequipment]    Script Date: 28/03/2022 2:37:58 PM ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO












CREATE PROCEDURE [dbo].[Cl_currentactiveequipment] 
	
AS
BEGIN

declare @time datetime=getdate()
	declare @lastday datetime
	set @lastday = dateadd(day,-1,@time)
SELECT 
      [PointValue]
      ,[IsAlarmed]
      ,[PointValueUpdatedTime],
	  AssetID,
	  PointTemplateName
  FROM [510cs].[dbo].[IBMSPointLastValues] v
  inner join IBMSPoints p on v.PointKey=p.PointKey
  inner join IBMSPointTemplates pt on pt.PointTemplateKey=p.PointTemplateKey
  inner join assetmaster am on am.AssetKey=p.AssetKey
  where PointTemplateName like '%Run Status%'
  and PointValue='1'
  and PointValueUpdatedTime>@lastday
  order by AssetID asc

 end
GO


